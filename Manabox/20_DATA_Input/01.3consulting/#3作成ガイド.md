# #3作成ガイド

## 概要

#1（実績）と#2（予算）のCSVファイルから#3を作成する方法を説明します。

## #3の種類

### 1. 月次DB（Plan/Actual形式）
- **用途**: Looker Studioでの可視化用
- **内容**: 月次金額データ + Plan/Actual区分
- **ファイル**: `月次DB_SharePoint用.csv`

### 2. マスターフォーマット#3（Account Code構造）
- **用途**: Account Code構造のマスター
- **内容**: Account Code階層構造のみ（金額なし）
- **ファイル**: `マスターフォーマット#3_最終版.csv`

---

## 方法1: 月次DB（Plan/Actual形式）を作成

### 手順

1. **ターミナルで実行**:
```bash
cd /Users/sugenotomohiro/Desktop/CURSOR/Manabox/20_DATA_Input/01.3consulting
python3 merge_actual_budget.py
```

2. **出力ファイル**:
   - `月次DB_SharePoint用.csv`
   - Plan/Actual各1482件のレコード

3. **データ構造**:
   - `Year_Month`: 年月（2025-04など）
   - `Account_Code`: アカウントコード
   - `Type`: Plan（予算）またはActual（実績）
   - `Amount`: 金額

### 使用例

Looker Studioで：
- `Type`列でPlan/Actualをフィルタリング
- 月次推移を可視化
- 実績と予算を比較

---

## 方法2: マスターフォーマット#3（Account Code構造）を作成

### 手順

1. **元データファイルを確認**:
   - `Glory　Format_Source Data.csv`（#1と#2の構造と予算金額）

2. **ターミナルで実行**:
```bash
cd /Users/sugenotomohiro/Desktop/CURSOR/Manabox/20_DATA_Input/01.3consulting
python3 create_master_final.py
```

3. **出力ファイル**:
   - `マスターフォーマット#3_最終版.csv`
   - Account Code構造のみ（金額なし）

---

## よくある質問

### Q: どの方法を使えばいいですか？

**A**: 目的によって異なります。

- **Looker Studioで可視化したい** → 方法1（月次DB）
- **Account Code構造のマスターが必要** → 方法2（マスターフォーマット）

### Q: #1と#2から直接#3を作れますか？

**A**: はい。`merge_actual_budget.py`が#1と#2を読み込んで月次DB（#3形式）を作成します。

### Q: エラーが出た場合は？

**A**: 以下を確認してください：
1. ファイルパスが正しいか
2. CSVファイルが正しく保存されているか
3. Python3がインストールされているか

---

## 次のステップ

1. **月次DBを作成**: `merge_actual_budget.py`を実行
2. **SharePointにアップロード**: `月次DB_SharePoint用.csv`をアップロード
3. **Looker Studioで接続**: Type列でPlan/Actualをフィルタリング

---

## ファイル一覧

| ファイル名 | 説明 | スクリプト |
|---------|------|----------|
| `月次DB_SharePoint用.csv` | Plan/Actual形式の月次DB | `merge_actual_budget.py` |
| `マスターフォーマット#3_最終版.csv` | Account Code構造のマスター | `create_master_final.py` |

