# SharePointへのアップロード手順

## 📋 概要

`月次DB_SharePoint用.csv`をSharePointにアップロードして、Looker Studioで接続するまでの手順を説明します。

---

## 🚀 方法1: SharePoint Webからアップロード（推奨）

### ステップ1: SharePointにアクセス

1. ブラウザでSharePointサイトにアクセス
2. データを保存するライブラリ（ドキュメント）を開く

### ステップ2: ファイルをアップロード

1. **「アップロード」**ボタンをクリック
2. **「ファイル」**を選択
3. `月次DB_SharePoint用.csv`を選択
4. **「開く」**をクリック

### ステップ3: ファイルを確認

- アップロードが完了したら、ファイルがライブラリに表示されます
- ファイル名を確認してください

---

## 📊 方法2: Excelで開いてからアップロード

### ステップ1: Excelで開く

1. `月次DB_SharePoint用.csv`をエクセルで開く
   - ファイルを右クリック → **「プログラムから開く」** → **「Excel」**
   - または、Excelを起動して **「ファイル」** → **「開く」**

2. データが正しく表示されているか確認
   - 列が正しく分かれているか
   - 文字化けしていないか

### ステップ2: Excel形式で保存（オプション）

必要に応じて、Excel形式（.xlsx）で保存：

1. **「ファイル」** → **「名前を付けて保存」**
2. ファイル名: `月次DB_SharePoint用.xlsx`
3. ファイルの種類: **「Excelブック（*.xlsx）」**
4. **「保存」**をクリック

### ステップ3: SharePointにアップロード

1. SharePointサイトにアクセス
2. ライブラリを開く
3. **「アップロード」** → **「ファイル」**
4. 保存したExcelファイル（.xlsx）またはCSVファイルを選択

---

## 🔗 方法3: OneDriveからアップロード

### ステップ1: OneDriveにアップロード

1. OneDriveにアクセス（https://onedrive.live.com）
2. **「アップロード」**をクリック
3. `月次DB_SharePoint用.csv`を選択

### ステップ2: SharePointと共有

1. アップロードしたファイルを右クリック
2. **「共有」**を選択
3. SharePointサイトへのリンクを取得

---

## ⚙️ 重要な注意事項

### 1. ファイル形式について

- **CSV形式のまま**: Looker Studioで直接接続可能
- **Excel形式に変換**: より見やすく、スタイルを適用可能

### 2. 文字エンコーディング

- ファイルは**UTF-8 with BOM**形式で保存されています
- 日本語が正しく表示されるはずです
- 文字化けする場合は、Excelで開いて再保存してください

### 3. ファイル名について

- ファイル名は変更しても問題ありません
- ただし、Looker Studioで接続する際は、ファイル名を覚えておいてください

### 4. データ更新について

- 新しい月次データを追加する場合は：
  1. 新しいCSVファイルを生成
  2. SharePointの既存ファイルを置き換える
  3. または、新しいファイルとして追加（履歴管理）

---

## 📈 Looker Studioでの接続方法

### ステップ1: データソースを追加

1. Looker Studioを開く
2. **「作成」** → **「データソース」**
3. **「ファイルアップロード」**を選択
4. SharePointのファイルを選択

### ステップ2: データを確認

1. データが正しく読み込まれているか確認
2. 列の型を確認（特に`Amount`は数値型）
3. `Type`列がテキスト型になっているか確認

### ステップ3: 可視化の作成

1. **「レポートを作成」**をクリック
2. `Type`フィルタでPlan/Actualを切り替え
3. 月次推移をグラフ化

---

## 🔄 今後の更新フロー

### 月次データを追加する場合

1. **新しいデータを準備**
   - `Glory Format - #1MonthlyPL(Actual) .csv`（新しい月の実績）
   - `Glory Format - #2Monthly PL(Budget).csv`（新しい月の予算）

2. **スクリプトを実行**
   ```bash
   cd /Users/sugenotomohiro/Desktop/CURSOR/Manabox/20_DATA_Input/01.3consulting
   python3 merge_actual_budget.py
   ```

3. **SharePointを更新**
   - 方法A: 既存ファイルを置き換える（推奨）
   - 方法B: 新しいファイルとして追加（履歴管理）

---

## 🆘 トラブルシューティング

### 問題1: 文字化けが発生する

**解決方法:**
1. Excelでファイルを開く
2. **「データ」** → **「テキスト/CSVから」**
3. エンコーディングを**「UTF-8」**に設定
4. 読み込み後、Excel形式で保存

### 問題2: Looker Studioで接続できない

**解決方法:**
1. ファイルがSharePointで正しくアップロードされているか確認
2. ファイルの共有設定を確認（読み取り権限が必要）
3. CSV形式の場合は、Excel形式に変換してからアップロード

### 問題3: データが更新されない

**解決方法:**
1. Looker Studioでデータソースを更新
2. キャッシュをクリア
3. データソースを再読み込み

---

## 📞 サポート

問題が解決しない場合は、以下を確認してください：

1. ファイルサイズ（大容量ファイルは時間がかかる場合があります）
2. ネットワーク接続
3. SharePointの権限設定

---

## ✅ チェックリスト

アップロード前の確認：

- [ ] CSVファイルが正しく生成されている
- [ ] ファイルサイズが適切（通常は数MB以下）
- [ ] データが正しく表示されている（Excelで確認）
- [ ] SharePointのアクセス権限がある

アップロード後の確認：

- [ ] ファイルがSharePointに表示されている
- [ ] ファイルを開いてデータが正しく表示される
- [ ] Looker Studioで接続できる
- [ ] データが正しく読み込まれる

---

最終更新日: 2025年1月





